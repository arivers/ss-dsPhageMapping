#!/bin/bash
#BBTools version 36.11
#The steps below recapitulate the output of RQCFilter when run like this:
#rqcfilter.sh usejni in=/global/dna/dm_archive/sdm/illumina/01/05/98/10598.1.166606.GTCCG.fastq.gz path=BAYTG library=frag rna=f threads=16 pigz=t unpigz=t phix=f removehuman=t removedog=t removecat=t removemouse=t threads= qtrim=t removemicrobes=t

bbduk.sh maq=5,0 trimq=10 qtrim=true overwrite=true maxns=0 minlen=25 minlenfraction=0.333 k=27 hdist=1 pigz=t unpigz=t cf=t barcodefilter=crash ow=true in1=/global/dna/dm_archive/sdm/illumina/01/05/98/10598.1.166606.GTCCG.fastq.gz out1=/scratch/tmp/22861305.1.normal_excl.q/TEMP_FILTER_3f012047d0901f94ed3737c61a023_10598.1.166606.GTCCG.anqdht.fastq.gz outm=BAYTG/synth.fq.gz rqc=hashmap outduk=BAYTG/kmerStats.txt stats=BAYTG/scaffoldStats.txt loglog ref=/global/dna/shared/rqc/ref_databases/qaqc/databases/illumina.artifacts/Illumina.artifacts.2013.12.no_DNA_RNA_spikeins.fa,/global/dna/shared/rqc/ref_databases/qaqc/databases/illumina.artifacts/DNA_spikeins.artifacts.2012.10.fa,/global/dna/shared/rqc/ref_databases/qaqc/databases/pJET1.2.fasta
bbmap.sh quickmatch k=13 idtag=t printunmappedcount ow=true qtrim=rl trimq=10 untrim build=1 null path=/global/projectb/sandbox/gaag/bbtools/commonMicrobes/ pigz=t unpigz=t minid=.95 idfilter=.95 maxindel=3 minhits=2 bw=12 bwr=0.16 null maxsites2=10 tipsearch=0 in1=/scratch/tmp/22861305.1.normal_excl.q/TEMP_FILTER_3f012047d0901f94ed3737c61a023_10598.1.166606.GTCCG.anqdht.fastq.gz outu1=/scratch/tmp/22861305.1.normal_excl.q/TEMP_MICROBE_3f012047d0901f94ed3737c61a023_10598.1.166606.GTCCG.anqdht.fastq.gz outm=BAYTG/microbes.fq.gz scafstats=BAYTG/commonMicrobes.txt
rm /scratch/tmp/22861305.1.normal_excl.q/TEMP_FILTER_3f012047d0901f94ed3737c61a023_10598.1.166606.GTCCG.anqdht.fastq.gz
bbmap.sh k=14 idtag=t usemodulo printunmappedcount ow=true qtrim=r trimq=10 untrim kfilter=25 maxsites=1 tipsearch=0 minratio=.9 maxindel=3 minhits=2 bw=12 bwr=0.16 fast=true maxsites2=10 outm=BAYTG/human.fq.gz path=/global/projectb/sandbox/gaag/bbtools/mousecatdoghuman/ refstats=BAYTG/refStats.txt pigz=t unpigz=t in1=/scratch/tmp/22861305.1.normal_excl.q/TEMP_MICROBE_3f012047d0901f94ed3737c61a023_10598.1.166606.GTCCG.anqdht.fastq.gz outu1=BAYTG/10598.1.166606.GTCCG.anqdht.fastq.gz
rm /scratch/tmp/22861305.1.normal_excl.q/TEMP_MICROBE_3f012047d0901f94ed3737c61a023_10598.1.166606.GTCCG.anqdht.fastq.gz
bbmerge.sh loose overwrite=true in1=BAYTG/10598.1.166606.GTCCG.anqdht.fastq.gz ihist=BAYTG/ihist_merge.txt outc=BAYTG/cardinality.txt pigz=t unpigz=t adapters=/global/projectb/sandbox/gaag/bbtools/data/adapters.fa
